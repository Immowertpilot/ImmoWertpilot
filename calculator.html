<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Immobilien-Wertermittlung | Property Valuation Professional</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="css/calculator-styles.css">
    <link rel="stylesheet" href="css/improved-costs-panel.css">
    <link rel="stylesheet" href="css/layout-adjustments.css">
    <link rel="stylesheet" href="css/formula-styles.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container d-flex justify-content-between align-items-center">
            <a class="navbar-brand" href="index.html">
                <img src="images/logo.svg" alt="ImmoWertpilot Logo" height="40" class="me-2">
                ImmoWertpilot
            </a>
            <div class="d-flex align-items-center">
                <div class="language-switcher me-3">
                    <button class="btn btn-outline-light btn-sm" onclick="switchLanguage('de')">DE</button>
                    <button class="btn btn-outline-light btn-sm ms-2" onclick="switchLanguage('en')">EN</button>
                </div>
                <a href="index.html" class="btn btn-outline-light btn-sm">
                    <i class="fas fa-home me-1"></i> Startseite
                </a>
            </div>
        </div>
    </nav>

    <div class="dashboard">
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                    <div class="dashboard-metric">
                        <div class="metric-value" id="dashboardTotalInvestment">-</div>
                        <p class="metric-label" data-i18n="totalInvestment">Gesamtinvestition</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="dashboard-metric">
                        <div class="metric-value" id="dashboardOperatingCashflow">-</div>
                        <p class="metric-label" data-i18n="operatingCashflow">Operativer Cashflow mtl.</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="dashboard-metric">
                        <div class="metric-value" id="dashboardTaxCashflow">-</div>
                        <p class="metric-label" data-i18n="taxCashflow">Cashflow n. Steuern mtl.</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="dashboard-metric">
                        <div class="metric-value" id="dashboardROE">-</div>
                        <p class="metric-label" data-i18n="equityReturn">Eigenkapitalrendite</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-calculator"></i> Property Valuation Tool</span>
                        <div>
                            <button id="calculateBtn" class="btn btn-primary" data-i18n="calculate">Berechnen</button>
                            <button id="resetBtn" class="btn btn-secondary ml-2" data-i18n="reset">Zurücksetzen</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main container with two columns -->
        <div class="row">
            <!-- Left Column - User Input Sections -->
            <div class="col-md-6">
                <!-- Basic Data -->
                <div class="card mb-3">
                    <div class="card-header"><i class="fas fa-info-circle"></i> <span data-i18n="basicData">Basisdaten</span></div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group col-12">
                                <label for="address" data-i18n="address">Adresse</label>
                                <input type="text" id="address" class="form-control">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-12">
                                <label for="city" data-i18n="city">Stadt</label>
                                <input type="text" id="city" class="form-control">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-6">
                                <label for="livingArea" data-i18n="livingArea">Wohnfläche (m²)</label>
                                <input type="number" id="livingArea" class="form-control" min="0" step="0.01">
                            </div>
                            <div class="form-group col-6">
                                <label for="purchasePrice" data-i18n="purchasePrice">Kaufpreis (€)</label>
                                <input type="number" id="purchasePrice" class="form-control" min="0" step="1000">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-12">
                                <label data-i18n="pricePerSqm">Preis pro m²</label>
                                <input type="text" id="pricePerSqm" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                        
                        <!-- Cost Settings Section (moved from detailed breakdown) -->
                        <div class="cost-settings-section mt-4">
                            <h5 class="settings-title mb-3" data-i18n="costSettings">Kosteneinstellungen</h5>
                            
                            <div class="form-row">
                                <div class="form-group col-12">
                                    <label for="state" data-i18n="state">Bundesland</label>
                                    <select id="state" class="form-control">
                                        <option value="" data-i18n="pleaseSelect">Bitte wählen...</option>
                                        <option value="baden-wuerttemberg">Baden-Württemberg</option>
                                        <option value="bayern">Bayern</option>
                                        <option value="berlin">Berlin</option>
                                        <option value="brandenburg">Brandenburg</option>
                                        <option value="bremen">Bremen</option>
                                        <option value="hamburg">Hamburg</option>
                                        <option value="hessen">Hessen</option>
                                        <option value="mecklenburg-vorpommern">Mecklenburg-Vorpommern</option>
                                        <option value="niedersachsen">Niedersachsen</option>
                                        <option value="nordrhein-westfalen">Nordrhein-Westfalen</option>
                                        <option value="rheinland-pfalz">Rheinland-Pfalz</option>
                                        <option value="saarland">Saarland</option>
                                        <option value="sachsen">Sachsen</option>
                                        <option value="sachsen-anhalt">Sachsen-Anhalt</option>
                                        <option value="schleswig-holstein">Schleswig-Holstein</option>
                                        <option value="thueringen">Thüringen</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-12">
                                    <label for="realEstateAgent">Immobilienmakler</label>
                                    <select id="realEstateAgent" class="form-control">
                                        <option value="no">Nein</option>
                                        <option value="yes">Ja</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group col-6">
                                    <label>Grunderwerbsteuer</label>
                                    <div class="input-group">
                                        <input type="text" id="propertyTransferTaxPercent" class="form-control calculated-value" readonly>
                                        <div class="input-group-append">
                                            <span class="input-group-text">%</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group col-6">
                                    <label>Maklerprovision</label>
                                    <div class="input-group">
                                        <input type="text" id="realEstateAgentPercent" class="form-control" value="3.75">
                                        <div class="input-group-append">
                                            <span class="input-group-text">%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Hidden fields to maintain compatibility with existing JS -->
                            <div class="d-none">
                                <input type="text" id="notaryFeesPercent" value="1.50">
                                <input type="text" id="landRegistryPercent" value="0.50">
                            </div>
                        </div>
                        
                        <!-- Furniture & Renovation (Combined) -->
                        <div class="mt-4 pt-3 border-top">
                            <h5 class="mb-3"><i class="fas fa-tools mr-2"></i><i class="fas fa-couch mr-2"></i> <span data-i18n="renovationAndFurniture">Möbel & Zusätzliche Kosten (Renovierung)</span></h5>
                            
                            <!-- Furniture Section -->
                            <div class="cost-settings-section mb-3">
                                <h6 class="settings-title mb-3"><i class="fas fa-couch mr-2"></i> <span data-i18n="furniture">Möbel</span></h6>
                                <div class="form-row">
                                    <div class="form-group col-12">
                                        <label for="furniture" data-i18n="furniture">Möbel</label>
                                        <input type="number" id="furniture" class="form-control" min="0">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Renovation Section -->
                            <div class="cost-settings-section">
                                <h6 class="settings-title mb-3"><i class="fas fa-tools mr-2"></i> <span data-i18n="renovation">Zusätzliche Kosten (Renovierung)</span></h6>
                                <div class="form-row">
                                    <div class="form-group col-6">
                                        <label for="renovationBathroom" data-i18n="bathroom">Badezimmer</label>
                                        <input type="number" id="renovationBathroom" class="form-control" min="0">
                                    </div>
                                    <div class="form-group col-6">
                                        <label for="renovationKitchen" data-i18n="kitchen">Küche</label>
                                        <input type="number" id="renovationKitchen" class="form-control" min="0">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group col-6">
                                        <label for="renovationLivingArea" data-i18n="livingRoom">Wohnbereich</label>
                                        <input type="number" id="renovationLivingArea" class="form-control" min="0">
                                    </div>
                                    <div class="form-group col-6">
                                        <label for="renovationEntrance" data-i18n="entrance">Eingang</label>
                                        <input type="number" id="renovationEntrance" class="form-control" min="0">
                                    </div>
                                </div>
                            
                                <!-- Summary Section -->
                                <div class="form-row mt-4">
                                    <div class="form-group col-12 col-sm-4">
                                        <label data-i18n="total">Gesamt</label>
                                        <input type="text" id="renovationTotal" class="form-control calculated-value" readonly>
                                    </div>
                                    <div class="form-group col-12 col-sm-4">
                                        <label data-i18n="renovationCosts">Renovierungskosten (%)</label>
                                        <div class="input-group">
                                            <input type="text" id="renovationPercentage" class="form-control calculated-value" readonly>
                                            <div class="input-group-append">
                                                <span id="renovationStatus" class="input-group-text"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group col-12 col-sm-4">
                                        <label data-i18n="afaNext3Years">AfA nächste 3 Jahre</label>
                                        <input type="text" id="afaNext3Years" class="form-control calculated-value" readonly>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Total Section with Divider -->
                            <div class="form-row mt-3">
                                <div class="form-group col-12">
                                    <label data-i18n="furnitureRenovationTotal">= Summe Möbel & Renovierung</label>
                                    <input type="text" id="furnitureRenovationTotal" class="form-control calculated-value font-weight-bold" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Rental Income Card -->
                <div class="card mb-3">
                    <div class="card-header"><i class="fas fa-hand-holding-usd"></i> <span data-i18n="rentalIncome">Mieteinnahmen</span></div>
                    <div class="card-body">
                        <div class="form-row mb-4">
                            <div class="form-group col-md-12">
                                <label for="coldRentPerSqm" data-i18n="coldRentPerSqm">Kaltmiete pro m² (€)</label>
                                <input type="number" id="coldRentPerSqm" class="form-control" min="0" step="0.1">
                            </div>
                        </div>
                        
                        <div class="value-pairs-container">
                            <div class="value-pair">
                                <div class="value-pair-group">
                                    <label class="value-pair-label" data-i18n="coldRent">Kaltmiete</label>
                                    <div class="d-flex justify-content-between">
                                        <div class="pr-2 flex-grow-1">
                                            <small class="text-muted" data-i18n="monthly">Monatlich</small>
                                            <input type="text" id="coldRentMonthly" class="form-control calculated-value" readonly>
                                        </div>
                                        <div class="pl-2 flex-grow-1">
                                            <small class="text-muted" data-i18n="yearly">Jährlich</small>
                                            <input type="text" id="coldRentYearly" class="form-control calculated-value" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="value-pair">
                                <div class="value-pair-group">
                                    <label class="value-pair-label" data-i18n="warmRent">Warmmiete</label>
                                    <div class="d-flex justify-content-between">
                                        <div class="pr-2 flex-grow-1">
                                            <small class="text-muted" data-i18n="monthly">Monatlich</small>
                                            <input type="text" id="warmRentMonthly" class="form-control calculated-value" readonly>
                                        </div>
                                        <div class="pl-2 flex-grow-1">
                                            <small class="text-muted" data-i18n="yearly">Jährlich</small>
                                            <input type="text" id="warmRentYearly" class="form-control calculated-value" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Financing Card -->
                <div class="card mb-3">
                    <div class="card-header"><i class="fas fa-money-bill-wave"></i> <span data-i18n="financing">Finanzierung</span></div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="equityAmount" data-i18n="equity">Eigenkapital (€)</label>
                                <input type="number" id="equityAmount" class="form-control" min="0">
                            </div>
                            <div class="form-group col-md-6">
                                <label data-i18n="loanAmount">Darlehensbetrag (€)</label>
                                <input type="text" id="loanAmount" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="loanInterestRate" data-i18n="interestRate">Darlehenszinsen (%)</label>
                                <input type="number" id="loanInterestRate" class="form-control" min="0" step="0.1" value="4.0">
                            </div>
                            <div class="form-group col-md-6">
                                <label for="repaymentRate" data-i18n="repaymentRate">Tilgung (%)</label>
                                <input type="number" id="repaymentRate" class="form-control" min="0" step="0.1" value="2.0">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label data-i18n="equityRatio">Equity Ratio</label>
                                <input type="text" id="equityPercentage" class="form-control calculated-value" readonly>
                            </div>
                            <div class="form-group col-md-4">
                                <label data-i18n="annuity">Annuität (%)</label>
                                <input type="text" id="annuityRate" class="form-control calculated-value" readonly>
                            </div>
                            <div class="form-group col-md-4">
                                <label data-i18n="monthlyRate">Monatliche Rate (€)</label>
                                <input type="text" id="annuityMonthly" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Column - Output/Results Sections -->
            <div class="col-md-6">
                <!-- Gesamtkosten & Kaufnebenkosten -->
                <div class="cost-overview-panel mb-3">
                    <div class="cost-overview-card">
                        <div class="cost-panel-header">
                            <i class="fas fa-euro-sign"></i> <span data-i18n="totalCosts">Gesamtkosten & Kaufnebenkosten</span>
                        </div>
                        <div class="cost-panel-body">
                            <!-- Visual breakdown of costs with tooltip info -->
                            <div class="cost-breakdown-header mb-2" data-i18n="costOverview">Kostenübersicht</div>
                            <div class="cost-visual-breakdown mb-3">
                                <div id="purchasePriceSegment" class="cost-visual-segment purchase-price" style="width: 80%;" title="Kaufpreis"></div>
                                <div id="propertyTaxSegment" class="cost-visual-segment property-tax" style="width: 5%;" title="Grunderwerbsteuer"></div>
                                <div id="agentFeeSegment" class="cost-visual-segment agent-fee" style="width: 7%;" title="Maklerprovision"></div>
                                <div id="notarySegment" class="cost-visual-segment notary" style="width: 5%;" title="Notargebühren"></div>
                                <div id="registrySegment" class="cost-visual-segment registry" style="width: 3%;" title="Grundbucheintrag"></div>
                            </div>
                            
                            <div class="cost-breakdown-compact mb-3">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <div class="d-flex align-items-center">
                                        <div class="cost-legend-color property-tax mr-2"></div>
                                        <span data-i18n="propertyTransferTax">Grunderwerbsteuer</span>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <span id="propertyTransferTaxValue" class="mr-2"></span>
                                        <span id="propertyTransferTaxPercentDisplay"></span>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <div class="d-flex align-items-center">
                                        <div class="cost-legend-color agent-fee mr-2"></div>
                                        <span data-i18n="realEstateAgentCommission">Maklerprovision</span>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <span id="realEstateAgentValue" class="mr-2"></span>
                                        <span id="realEstateAgentPercentDisplay"></span>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <div class="d-flex align-items-center">
                                        <div class="cost-legend-color notary mr-2"></div>
                                        <span data-i18n="notaryFees">Notargebühren</span>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <span id="notaryFeesValue" class="mr-2"></span>
                                        <span id="notaryFeesPercentDisplay"></span>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <div class="cost-legend-color registry mr-2"></div>
                                        <span data-i18n="landRegistry">Grundbucheintrag</span>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <span id="landRegistryValue" class="mr-2"></span>
                                        <span id="landRegistryPercentDisplay"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Summary of total costs -->
                            <div class="cost-total mb-3">
                                <div class="cost-total-label" data-i18n="totalCostsWithAdditional">Gesamtkosten (Kaufpreis + Nebenkosten)</div>
                                <div>
                                    <span class="cost-total-value" id="totalCosts"></span>
                                </div>
                            </div>
                            
                            <!-- Additional costs summary -->
                            <div class="cost-panel-section">
                                <div class="cost-item">
                                    <div class="cost-item-label" data-i18n="purchasePrice">Kaufpreis</div>
                                    <div class="d-flex align-items-center">
                                        <div class="cost-item-value" id="purchasePriceSummary"></div>
                                    </div>
                                </div>
                                <div class="cost-item">
                                    <div class="cost-item-label" data-i18n="additionalCostsValue">Kaufnebenkosten</div>
                                     <div class="cost-item-percent" id="additionalCostsTotalPercent"></div>
                                    <div class="d-flex align-items-center">
                                        <div class="cost-item-value" id="additionalCostsTotalValue"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Total Investment Section -->
                            <div class="cost-panel-section mt-4 pt-3 border-top">
                                <h6 class="settings-title mb-3"><i class="fas fa-money-bill-wave mr-2"></i> <span data-i18n="totalInvestment">Gesamtinvestition</span></h6>
                                
                                <!-- Furniture and Renovation Summary -->
                                <div class="compact-summary mb-3">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <div class="d-flex align-items-center">
                                            <div class="cost-legend-color furniture-color mr-2"></div>
                                            <span data-i18n="furniture">Möbel</span>
                                        </div>
                                        <div class="cost-item-value" id="furnitureSummary"></div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <div class="d-flex align-items-center">
                                            <div class="cost-legend-color renovation-color mr-2"></div>
                                            <span data-i18n="renovation">Renovierung</span>
                                        </div>
                                        <div class="cost-item-value" id="renovationSummary"></div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <div class="d-flex align-items-center">
                                            <small class="text-muted" data-i18n="furnitureRenovationTotal">Summe (Möbel + Renovierung)</small>
                                        </div>
                                        <div class="cost-item-value font-weight-bold" id="furnitureRenovationSummary"></div>
                                    </div>
                                </div>

                                <div class="cost-item investment-row">
                                    <div class="cost-item-label" data-i18n="totalInvestment">Gesamtinvestitionskosten</div>
                                    <div class="d-flex align-items-center">
                                        <div class="cost-item-value font-weight-bold investment-highlight" id="totalInvestmentCosts"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Added reference to website -->
                            <div class="mt-2 text-right">
                                <small class="text-muted">
                                    <a href="https://www.gutachterausschuesse-bw.de/borisbw/?lang=en" target="_blank" class="text-muted">
                                        <i class="fas fa-external-link-alt"></i> Bodenwert: gutachterausschuesse-bw.de
                                    </a>
                                </small>
                            </div>
                             <div class="mt-2 text-right">
                                <small class="text-muted">
                                    <a href="https://www.homeday.de/de " target="_blank" class="text-muted">
                                        <i class="fas fa-external-link-alt"></i> Wohnfleich Wert: homeday.de/de 
                                    </a>
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Rendite-Kennzahlen Card -->
                <div class="card mb-3">
                    <div class="card-header bg-info text-white">
                        <i class="fas fa-chart-bar"></i> <span>Rendite-Kennzahlen</span>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="investment-metric highlight-box p-3 text-center mb-3 mb-md-0">
                                    <h5 data-i18n="rentalYield">Mietrendite (%)</h5>
                                    <input type="text" id="netRentalYield" class="form-control calculated-value text-center font-weight-bold" style="font-size: 1.5rem; border: none; background: transparent;" readonly>
                                    <small class="text-muted">Jährliche Brutomietrendite</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="investment-metric highlight-box p-3 text-center mb-3 mb-md-0">
                                    <h5>Netto Mietrendite (%)</h5>
                                    <input type="text" id="nettoMietrendite" class="form-control calculated-value text-center font-weight-bold" style="font-size: 1.5rem; border: none; background: transparent;" readonly>
                                    <small class="text-muted">Jährliche Nettomietrendite</small>
                                    <div class="mt-2">
                                        <small class="formula-detail">
                                            <span id="coldRentYearlyValue">0</span> € (Kaltmiete/Jahr) −<br>
                                            <span id="expensesReservesTotalYearlyValue">0</span> € (Ausgaben/Jahr) ÷<br>
                                            <span id="totalInvestmentCostsValue">0</span> € (Gesamtinvestition) × 100
                                        </small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="investment-metric highlight-box p-3 text-center">
                                    <h5 data-i18n="priceToRentRatio">Kaufpreisfaktor</h5>
                                    <input type="text" id="priceToRentRatio" class="form-control calculated-value text-center font-weight-bold" style="font-size: 1.5rem; border: none; background: transparent;" readonly>
                                    <small class="text-muted">Verhältnis Kaufpreis zu Jahreskaltmiete</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Cashflow Card -->
                <div class="card mb-3">
                    <div class="card-header bg-success text-white">
                        <i class="fas fa-chart-line"></i> <span>Cashflow</span>
                    </div>
                    <div class="card-body">
                        <div class="value-pairs-container">
                            <div class="value-pair">
                                <div class="value-pair-group">
                                    <label class="value-pair-label" data-i18n="operatingCashflow">Operativer Cashflow</label>
                                    <div class="d-flex justify-content-between">
                                        <div class="pr-2 flex-grow-1">
                                            <small class="text-muted" data-i18n="monthly">Monatlich</small>
                                            <input type="text" id="operativeCashflowMonthly" class="form-control calculated-value font-weight-bold" readonly>
                                        </div>
                                        <div class="pl-2 flex-grow-1">
                                            <small class="text-muted" data-i18n="yearly">Jährlich</small>
                                            <input type="text" id="operativeCashflowYearly" class="form-control calculated-value" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="value-pair">
                                <div class="value-pair-group">
                                    <label class="value-pair-label" data-i18n="taxCashflow">Cashflow nach Steuern</label>
                                    <div class="d-flex justify-content-between">
                                        <div class="pr-2 flex-grow-1">
                                            <small class="text-muted" data-i18n="monthly">Monatlich</small>
                                            <input type="text" id="cashflowAfterTaxMonthly" class="form-control calculated-value font-weight-bold" readonly>
                                        </div>
                                        <div class="pl-2 flex-grow-1">
                                            <small class="text-muted" data-i18n="yearly">Jährlich</small>
                                            <input type="text" id="cashflowAfterTaxYearly" class="form-control calculated-value" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Eigenkapitalrendite Card -->
                <div class="card mb-3">
                    <div class="card-header bg-primary text-white">
                        <i class="fas fa-piggy-bank"></i> <span data-i18n="equityReturn">Eigenkapitalrendite</span>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group col-md-12 text-center">
                                <div class="gauge-container">
                                    <div class="gauge">
                                        <div id="equityReturnGaugeFill" class="gauge-fill"></div>
                                        <div class="gauge-cover"></div>
                                        <div id="equityReturnGaugePointer" class="gauge-pointer"></div>
                                    </div>
                                    <div class="gauge-value">
                                        <input type="text" id="equityReturn" class="form-control calculated-value text-center font-weight-bold" readonly style="background: transparent; border: none; font-size: 1.5rem;">
                                    </div>
                                </div>
                                <div class="traffic-lights">
                                    <div id="equityReturnLightRed" class="light red"></div>
                                    <div id="equityReturnLightYellow" class="light yellow"></div>
                                    <div id="equityReturnLightGreen" class="light green"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Expenses and Reserves Card in its own row -->
        <div class="row">
            <div class="col-12">
                <div class="card mb-3">
                    <div class="card-header"><i class="fas fa-file-invoice-dollar"></i> <span data-i18n="expensesAndReserves">Ausgaben und Rücklagen</span></div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="houseMoneyNonCoverableMonthly" data-i18n="nonCoverableExpenses">Nicht umlagefähige Nebenkosten (€/Monat)</label>
                                <input type="number" id="houseMoneyNonCoverableMonthly" class="form-control" min="0" step="1">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="utilityPrepaymentsMonthly" data-i18n="utilityPrepayments">Nebenkostenvorauszahlung (€/Monat)</label>
                                <input type="number" id="utilityPrepaymentsMonthly" class="form-control" min="0" step="1">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="vacancyRatePercentage" data-i18n="vacancyReserve">Mietausfall-Rücklage (%)</label>
                                <div class="input-group">
                                    <input type="number" id="vacancyRatePercentage" class="form-control" min="0" step="0.1" value="2">
                                    <div class="input-group-append">
                                        <span class="input-group-text">%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label data-i18n="vacancyReserve">Monatliche Mietausfall-Rücklage (€)</label>
                                <input type="text" id="vacancyReserveMonthly" class="form-control calculated-value" readonly>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="maintenanceReservePerSqm" data-i18n="maintenanceReserve">Instandhaltungsrücklagen pro qm (Annual reserve / pro qm)</label>
                                <input type="number" id="maintenanceReservePerSqm" class="form-control" min="0" step="0.1" value="10">
                            </div>
                            <div class="form-group col-md-4">
                                <label data-i18n="maintenanceReserve_calculated">Monatliche Instandhaltungsrücklage (€)</label>
                                <input type="text" id="maintenanceReserveMonthly" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label data-i18n="totalExpenses">Gesamtausgaben monatlich (€)</label>
                                <input type="text" id="expensesReservesTotalMonthly" class="form-control calculated-value font-weight-bold" readonly>
                            </div>
                            <div class="form-group col-md-6">
                                <label data-i18n="totalExpenses_jahr">Gesamtausgaben jährlich (€)</label>
                                <input type="text" id="expensesReservesTotalYearly" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tax Consideration Card in its own row -->
        <div class="row">
            <div class="col-12">
                <div class="card mb-3">
                    <div class="card-header"><i class="fas fa-balance-scale"></i> <span data-i18n="taxConsideration">Steuerliche Betrachtung</span></div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group col-md-3">
                                <label for="buildingYear" data-i18n="constructionYear">Baujahr</label>
                                <select id="buildingYear" class="form-control">
                                    <option value="after1925">Nach 1925 (2.0% AfA)</option>
                                    <option value="before1925">Vor 1925 (2.5% AfA)</option>
                                </select>
                            </div>
                            <div class="form-group col-md-3">
                                <label for="buildingShare" data-i18n="buildingShare">Gebäudeanteil (%)</label>
                                <div class="input-group">
                                    <input type="number" id="buildingShare" class="form-control" min="0" max="100" value="80">
                                    <div class="input-group-append">
                                        <span class="input-group-text">%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-md-3">
                                <label data-i18n="buildingValue">Gebäudewert (€)</label>
                                <input type="text" id="buildingValue" class="form-control calculated-value" readonly>
                            </div>
                            <div class="form-group col-md-3">
                                <label data-i18n="landValue">Grundstückswert (€)</label>
                                <input type="text" id="landValue" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-3">
                                <label>AfA Gebäude monatlich (€)</label>
                                <input type="text" id="buildingAfaMonthly" class="form-control calculated-value" readonly>
                            </div>
                            <div class="form-group col-md-3">
                                <label>AfA Gebäude jährlich (€)</label>
                                <input type="text" id="buildingAfaYearly" class="form-control calculated-value" readonly>
                            </div>
                            <div class="form-group col-md-3">
                                <label>Zinskosten monatlich (€)</label>
                                <input type="text" id="interestMonthly" class="form-control calculated-value" readonly>
                            </div>
                            <div class="form-group col-md-3">
                                <label>Tilgung monatlich (€)</label>
                                <input type="text" id="repaymentMonthly" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="furnitureDepreciationPeriod">Möbel AfA (Jahre)</label>
                                <select id="furnitureDepreciationPeriod" class="form-control">
                                    <option value="13">Standardmöbel (13 Jahre)</option>
                                    <option value="10">Kücheneinrichtung (10 Jahre)</option>
                                    <option value="8">Elektrogeräte (8 Jahre)</option>
                                    <option value="5">IT & Elektronik (5 Jahre)</option>
                                    <option value="3" selected>Geringwertige Güter (3 Jahre)</option>
                                </select>
                            </div>
                            <div class="form-group col-md-4">
                                <label>Möbel AfA jährlich (€)</label>
                                <input type="text" id="furnitureAfaYearly" class="form-control calculated-value" readonly>
                            </div>
                            <div class="form-group col-md-4">
                                <label>Möbel AfA monatlich (€)</label>
                                <input type="text" id="furnitureAfaMonthly" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-12">
                                <label>Verwaltungskosten (WEG Anteil) (€/Monat)</label>
                                <input type="text" id="verwaltungskostenWEG" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label>AfA Gesamt monatlich (€)</label>
                                <input type="text" id="afaGesamtMonthly" class="form-control calculated-value" readonly>
                            </div>
                            <div class="form-group col-md-6">
                                <label>AfA Gesamt jährlich (€)</label>
                                <input type="text" id="afaGesamtYearly" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-12">
                                <label>Cashflow nach AfA monatlich (€)</label>
                                <input type="text" id="cashflowNachAfaMonthly" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="taxRate">Persönlicher Steuersatz (%)</label>
                                <div class="input-group">
                                    <input type="number" id="taxRate" class="form-control" min="0" max="100" step="1" value="42">
                                    <div class="input-group-append">
                                        <span class="input-group-text">%</span>
                                    </div>
                                </div>
                                <div id="taxable-income-info" class="tax-info"></div>
                            </div>
                            <div class="form-group col-md-4">
                                <label>Monatliche Steuer (€)</label>
                                <input type="text" id="taxAmountMonthly" class="form-control calculated-value" readonly>
                            </div>
                            <div class="form-group col-md-4">
                                <label>Jährliche Steuer (€)</label>
                                <input type="text" id="taxAmountYearly" class="form-control calculated-value" readonly>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        

        
        <div class="row mt-4">
            <div class="col-12 text-center">
                <p class="text-muted">
                    <small>Property Valuation Professional &copy; 2025 • Alle berechnungen sind nur Schätzungen.</small>
                </p>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/js/bootstrap.min.js"></script>
    <script src="js/translations.js"></script>
    <script src="js/language-handler.js"></script>
    <script src="js/cost-panel.js"></script>
    <script src="js/pro_script.js"></script>
</body>
</html>